_subdirectory: template
_templates_suffix: .jinja

# Files that are generated once and never overwritten by copier update.
# These are the app's customization points.
_skip_if_exists:
  - app/startup.py
  - app/services/container.py
  - app/exceptions.py

# Exclude feature-flagged files when the feature is disabled.
_exclude:
  # Database files (excluded when use_database is false)
  - "{% if not use_database %}app/extensions.py{% endif %}"
  - "{% if not use_database %}app/database.py{% endif %}"
  - "{% if not use_database %}app/models/{% endif %}"
  - "{% if not use_database %}app/services/diagnostics_service.py{% endif %}"
  - "{% if not use_database %}app/utils/pool_diagnostics.py{% endif %}"
  - "{% if not use_database %}app/utils/empty_string_normalization.py{% endif %}"
  - "{% if not use_database %}alembic.ini{% endif %}"
  - "{% if not use_database %}alembic/{% endif %}"

  # OIDC files (excluded when use_oidc is false)
  - "{% if not use_oidc %}app/api/auth.py{% endif %}"
  - "{% if not use_oidc %}app/services/auth_service.py{% endif %}"
  - "{% if not use_oidc %}app/services/oidc_client_service.py{% endif %}"
  - "{% if not use_oidc %}app/utils/auth.py{% endif %}"

  # S3 files (excluded when use_s3 is false)
  - "{% if not use_s3 %}app/api/cas.py{% endif %}"
  - "{% if not use_s3 %}app/services/s3_service.py{% endif %}"
  - "{% if not use_s3 %}app/services/image_service.py{% endif %}"
  - "{% if not use_s3 %}app/utils/cas_url.py{% endif %}"
  - "{% if not use_s3 %}app/utils/image_processing.py{% endif %}"
  - "{% if not use_s3 %}app/utils/mime_handling.py{% endif %}"
  - "{% if not use_s3 %}app/schemas/upload_document.py{% endif %}"

  # SSE files (excluded when use_sse is false)
  # Note: connection_manager.py and sse_gateway_schema.py are always included
  # because TaskService depends on ConnectionManager which imports the schema
  - "{% if not use_sse %}app/api/sse.py{% endif %}"
  - "{% if not use_sse %}app/services/version_service.py{% endif %}"
  - "{% if not use_sse %}app/utils/sse_utils.py{% endif %}"
  - "{% if not use_sse %}app/utils/log_capture.py{% endif %}"

  # Always exclude
  - __pycache__
  - "*.pyc"
  - .git

# Template variables
project_name:
  type: str
  help: "Project name (used for package name, CLI name, etc.)"

project_description:
  type: str
  help: "Short project description"
  default: "A Flask backend application"

author_name:
  type: str
  help: "Author name"

author_email:
  type: str
  help: "Author email"

workspace_name:
  type: str
  help: "Docker workspace/registry name"
  default: "{{ project_name }}"

use_database:
  type: bool
  help: "Include SQLAlchemy database support with Alembic migrations"
  default: true

use_oidc:
  type: bool
  help: "Include OIDC authentication (BFF pattern with JWT)"
  default: false

use_s3:
  type: bool
  help: "Include S3 storage (CAS, image processing)"
  default: false

use_sse:
  type: bool
  help: "Include Server-Sent Events via SSE Gateway"
  default: false
