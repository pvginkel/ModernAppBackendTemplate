# test-app Environment Configuration
#
# Copy this file to .env and update values as needed.
# All values shown are defaults.

# ── Core Settings ─────────────────────────────────────────────────────

# Flask environment: development, testing, production
FLASK_ENV=development

# Debug mode (disable in production)
DEBUG=true

# Secret key for Flask sessions (MUST be changed in production)
SECRET_KEY=dev-secret-key-change-in-production

# Allowed CORS origins (comma-separated in env, JSON list in code)
CORS_ORIGINS=["http://localhost:3000"]

# ── Background Tasks ─────────────────────────────────────────────────

# Maximum number of concurrent background task workers
TASK_MAX_WORKERS=4

# Task execution timeout in seconds
TASK_TIMEOUT_SECONDS=300

# How often to clean up completed tasks (seconds)
TASK_CLEANUP_INTERVAL_SECONDS=600

# ── Metrics ───────────────────────────────────────────────────────────

# Background metrics update interval in seconds
METRICS_UPDATE_INTERVAL=60

# ── Shutdown ──────────────────────────────────────────────────────────

# Maximum seconds to wait for tasks during graceful shutdown
GRACEFUL_SHUTDOWN_TIMEOUT=600

# Bearer token for authenticating drain endpoint access
DRAIN_AUTH_KEY=

# ── Database (use_database) ───────────────────────────────────────────

# PostgreSQL connection string
DATABASE_URL=postgresql+psycopg://postgres:postgres@localhost:5432/test-app

# Connection pool settings
DB_POOL_SIZE=20
DB_POOL_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=10
DB_POOL_ECHO=false

# Request diagnostics (query timing and profiling)
DIAGNOSTICS_ENABLED=false
DIAGNOSTICS_SLOW_QUERY_THRESHOLD_MS=100
DIAGNOSTICS_SLOW_REQUEST_THRESHOLD_MS=500
DIAGNOSTICS_LOG_ALL_QUERIES=false

# ── OIDC Authentication (use_oidc) ───────────────────────────────────

# Base URL for the application (used for redirect URI and cookie security)
BASEURL=http://localhost:3000

# Enable/disable OIDC authentication
OIDC_ENABLED=false

# OIDC provider settings
OIDC_ISSUER_URL=https://auth.example.com/realms/myapp
OIDC_CLIENT_ID=my-backend
OIDC_CLIENT_SECRET=
OIDC_SCOPES=openid profile email
OIDC_AUDIENCE=

# Token validation
OIDC_CLOCK_SKEW_SECONDS=30

# Cookie settings
OIDC_COOKIE_NAME=access_token
OIDC_COOKIE_SECURE=
OIDC_COOKIE_SAMESITE=Lax
OIDC_REFRESH_COOKIE_NAME=refresh_token

# ── S3 Storage (use_s3) ──────────────────────────────────────────────

# S3-compatible endpoint URL (Ceph RGW, AWS, MinIO, etc.)
S3_ENDPOINT_URL=http://localhost:9000

# S3 credentials
S3_ACCESS_KEY_ID=admin
S3_SECRET_ACCESS_KEY=password

# S3 bucket and region
S3_BUCKET_NAME=test-app-attachments
S3_REGION=us-east-1
S3_USE_SSL=false

# ── Server-Sent Events (use_sse) ─────────────────────────────────────

# URL to fetch frontend version information
FRONTEND_VERSION_URL=http://localhost:3000/version.json

# SSE heartbeat interval in seconds (5 for dev, 30 for production auto)
SSE_HEARTBEAT_INTERVAL=5

# SSE Gateway base URL
SSE_GATEWAY_URL=http://localhost:3001

# Shared secret for authenticating SSE Gateway callbacks
SSE_CALLBACK_SECRET=
